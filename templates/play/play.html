{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Play</title>

    <script type="text/javascript">
        function f()
        {
            var ships = [];

            {% for ship in game.ships.all %}
                var id = '{{ ship.id }}';
                var url = '{{ ship.image.url }}';
                var image = document.createElement("IMG");
                image.src = url;
                var x = '{{ ship.x }}', y = '{{ ship.y }}';
                var speed = '{{ ship.speed }}', angle = '{{ ship.angle }}';
                var racing = '{{ ship.racing }}', rotate = '{{ ship.rotate }}', braking = '{{ ship.braking }}';

                var weapons = [];

                {% for weapon in ship.weapons.all %}
                    var w_id = '{{ weapon.id }}';
                    var w_url = '{{ weapon.image.url }}';
                    var w_image = document.createElement("IMG");
                    w_image.src = w_url;
                    var w_title = '{{ weapon.title }}';

                    var w = new Weapon(parseInt(w_id), w_image, w_title);
                    weapons.push(w);
                {% endfor %}

                var s = new Ship(parseInt(id), image, parseFloat(racing), parseFloat(braking), parseFloat(speed), parseFloat(rotate), parseFloat(angle), parseFloat(x), parseFloat(y), weapons);
                ships.push(s);
            {% endfor %}

            var image1 = document.createElement("IMG");
            var url1 = '{{ game.map.image.url }}';
            image1.src = url1;

            var map = new Map(image1);

            var index = parseInt('{{ index }}');

            init(map, ships, index, parseInt('{{ game.id }}'));
        }
    </script>

</head>

<body onload="f()">

    <canvas id="myCanvas" width="1300" height="550" style="border:1px solid #d3d3d3; width:100%;height:50%">

    </canvas>

    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <script src="{% static 'js/play.js' %}"></script>

</body>

</html>